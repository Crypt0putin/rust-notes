# E0502: –ù–µ–ª—å–∑—è –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫ –∏–∑–º–µ–Ω—è–µ–º–æ–µ

**–ö–∞—Ç–µ–≥–æ—Ä–∏—è**: Borrowing Error  
**–ß–∞—Å—Ç–æ—Ç–∞**: ‚≠ê‚≠ê‚≠ê‚≠ê –û—á–µ–Ω—å —á–∞—Å—Ç–∞—è  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: üü° –°—Ä–µ–¥–Ω—è—è

## üö´ –û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å —Å–æ–∑–¥–∞—Ç—å –∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, –ø–æ–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–æ–≥–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏—è.

## üí• –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

### –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π
```rust
let mut s = String::from("hello");
let r1 = &s;        // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
let r2 = &mut s;    // ‚ùå Error: cannot borrow as mutable
println!("{} {}", r1, r2);
```

**–°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞:**
```
error[E0502]: cannot borrow `s` as mutable because it is also borrowed as immutable
 --> src/main.rs:3:14
  |
2 |     let r1 = &s;
  |              -- immutable borrow occurs here
3 |     let r2 = &mut s;
  |              ^^^^^^ mutable borrow occurs here
4 |     println!("{} {}", r1, r2);
  |                       -- immutable borrow later used here
```

### –í —Ñ—É–Ω–∫—Ü–∏—è—Ö
```rust
fn process_string(s: &mut String) {
    let immutable_ref = &*s;        // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
    s.push_str(" world");           // ‚ùå Error: –ø—ã—Ç–∞–µ–º—Å—è –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ s
    println!("{}", immutable_ref);
}
```

### –í —Ü–∏–∫–ª–∞—Ö
```rust
let mut vec = vec![1, 2, 3, 4, 5];
let first = &vec[0];               // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ

for item in &mut vec {             // ‚ùå Error: –∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
    *item *= 2;
}
println!("First: {}", first);      // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
```

### –° –º–µ—Ç–æ–¥–∞–º–∏
```rust
let mut s = String::from("hello");
let len = s.len();                 // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (&self)
s.push_str(" world");              // ‚ùå Error: –∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (&mut self)
println!("Length was: {}", len);
```

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
```rust
let mut s = String::from("hello");

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
{
    let r1 = &s;
    let r2 = &s;
    println!("{} and {}", r1, r2);
} // r1 –∏ r2 –≤—ã—Ö–æ–¥—è—Ç –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏

// –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É
let r3 = &mut s;
r3.push_str(" world");
println!("{}", r3);
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Non-Lexical Lifetimes (NLL)
```rust
let mut s = String::from("hello");
let r1 = &s;
let r2 = &s;
println!("{} and {}", r1, r2); // –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ r1 –∏ r2

// ‚úÖ OK: r1 –∏ r2 –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
let r3 = &mut s;
r3.push_str(" world");
println!("{}", r3);
```

### 3. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∫–æ–ø–∏–π
```rust
let mut s = String::from("hello");
let r1 = s.clone();             // –°–æ–∑–¥–∞—ë–º –∫–æ–ø–∏—é
let r2 = &mut s;                // ‚úÖ OK: –∏–∑–º–µ–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª
r2.push_str(" world");
println!("Original: {}, Copy: {}", r2, r1);
```

### 4. –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞
```rust
// –í–º–µ—Å—Ç–æ:
fn bad_example(s: &mut String) {
    let len = s.len();          // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
    s.push_str(" world");       // ‚ùå –∫–æ–Ω—Ñ–ª–∏–∫—Ç
    println!("Length was: {}", len);
}

// –õ—É—á—à–µ:
fn good_example(s: &mut String) {
    let len = s.len();          // –ø–æ–ª—É—á–∞–µ–º –¥–ª–∏–Ω—É
    println!("Length was: {}", len); // –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–∞–∑—É
    s.push_str(" world");       // —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å
}
```

### 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö owned –∑–Ω–∞—á–µ–Ω–∏—è
```rust
let mut vec = vec![1, 2, 3, 4, 5];
let first_copy = vec[0];        // –∫–æ–ø–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–µ –±–µ—Ä—ë–º —Å—Å—ã–ª–∫—É

for item in &mut vec {          // ‚úÖ OK: –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π
    *item *= 2;
}
println!("First was: {}", first_copy);
```

## ü§î –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

### –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è Rust:
1. **–õ–∏–±–æ –æ–¥–Ω–∞ –∏–∑–º–µ–Ω—è–µ–º–∞—è —Å—Å—ã–ª–∫–∞**
2. **–õ–∏–±–æ –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫**  
3. **–ù–æ –ù–ï –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**

### –ü—Ä–∏—á–∏–Ω—ã —ç—Ç–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞:
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ data races** –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–≤** 
- **–ì–∞—Ä–∞–Ω—Ç–∏—è thread safety**

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º –±–µ–∑ —ç—Ç–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞:
```rust
// –ï—Å–ª–∏ –±—ã —ç—Ç–æ –±—ã–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ:
let mut vec = vec![1, 2, 3];
let first = &vec[0];           // —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
vec.clear();                   // –æ—á–∏—â–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä
println!("{}", first);         // ‚ùå –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è!
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ö–∞–∫ –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É:
1. **–ù–∞–π–¥–∏—Ç–µ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ** - —Å—Ç—Ä–æ–∫–∞ —Å `&value`
2. **–ù–∞–π–¥–∏—Ç–µ –∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ** - —Å—Ç—Ä–æ–∫–∞ —Å `&mut value`
3. **–ü—Ä–æ—Å–ª–µ–¥–∏—Ç–µ –æ–±–ª–∞—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –≥–¥–µ —Å—Å—ã–ª–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑

### –ü–æ–ª–µ–∑–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:
- –ù—É–∂–Ω—ã –ª–∏ –º–Ω–µ –æ–±–µ —Å—Å—ã–ª–∫–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?
- –ú–æ–≥—É –ª–∏ —è –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π?
- –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å owned –∑–Ω–∞—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ —Å—Å—ã–ª–æ–∫?
- –ú–æ–∂–Ω–æ –ª–∏ —Ä–∞–∑–±–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ —á–∞—Å—Ç–∏?

## üí° –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π
```rust
// –ü–ª–æ—Ö–æ - –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ —Å—Å—ã–ª–∫–∏:
fn process_data(data: &mut Vec<i32>) {
    let first = &data[0];       // –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∞—è —Å—Å—ã–ª–∫–∞
    // ... –º–Ω–æ–≥–æ –∫–æ–¥–∞ ...
    data.push(42);              // ‚ùå –∫–æ–Ω—Ñ–ª–∏–∫—Ç
    println!("First: {}", first);
}

// –õ—É—á—à–µ - –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏:
fn process_data(data: &mut Vec<i32>) {
    {
        let first = &data[0];   
        println!("First: {}", first); // –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–∞–∑—É
    }
    data.push(42);              // ‚úÖ OK
}
```

### 2. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ owned –∑–Ω–∞—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∞–º –∫–æ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω–æ
```rust
// –í–º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫:
struct BadExample<'a> {
    name: &'a str,
    data: &'a mut Vec<i32>,
}

// –õ—É—á—à–µ owned –∑–Ω–∞—á–µ–Ω–∏—è:
struct GoodExample {
    name: String,
    data: Vec<i32>,
}
```

### 3. –†–∞–∑–¥–µ–ª—è–π—Ç–µ —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å
```rust
// –í–º–µ—Å—Ç–æ —Å–º–µ—à–∏–≤–∞–Ω–∏—è:
fn mixed_operations(data: &mut Vec<i32>) {
    let len = data.len();           // —á—Ç–µ–Ω–∏–µ
    data.push(42);                  // –∑–∞–ø–∏—Å—å
    let first = data.first();       // ‚ùå –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç
}

// –õ—É—á—à–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å:
fn separated_operations(data: &mut Vec<i32>) -> Option<i32> {
    // –°–Ω–∞—á–∞–ª–∞ –≤—Å–µ —á—Ç–µ–Ω–∏—è
    let len = data.len();
    let first = data.first().copied();
    
    // –ü–æ—Ç–æ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏
    data.push(42);
    
    first
}
```

## üéØ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –†–∞–±–æ—Ç–∞ —Å HashMap
```rust
use std::collections::HashMap;

let mut map = HashMap::new();
map.insert("key1".to_string(), "value1".to_string());

// ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
let value = map.get("key1");        // –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
map.insert("key2".to_string(), "value2".to_string()); // –∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ

// ‚úÖ –†–µ—à–µ–Ω–∏–µ:
let value = map.get("key1").cloned(); // –ø–æ–ª—É—á–∞–µ–º owned –∫–æ–ø–∏—é
map.insert("key2".to_string(), "value2".to_string()); // —Ç–µ–ø–µ—Ä—å OK
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–µ–∫—Ç–æ—Ä–∞
```rust
let mut numbers = vec![1, 2, 3, 4, 5];

// ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
let first = &numbers[0];
for num in &mut numbers {
    *num *= 2;
}
println!("First was: {}", first);

// ‚úÖ –†–µ—à–µ–Ω–∏–µ 1 - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
let first = numbers[0];             // –∫–æ–ø–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
for num in &mut numbers {
    *num *= 2;
}
println!("First was: {}", first);

// ‚úÖ –†–µ—à–µ–Ω–∏–µ 2 - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:
println!("First is: {}", numbers[0]); // –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–∞–∑—É
for num in &mut numbers {
    *num *= 2;
}
```

## üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –ò—Å–ø—Ä–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é
```rust
fn append_and_return_first(vec: &mut Vec<String>) -> &String {
    let first = &vec[0];        // ‚ùå –ò—Å–ø—Ä–∞–≤—å—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é
    vec.push("new".to_string());
    first
}
```

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫
```rust
fn process_string(s: &mut String) {
    let len = s.len();
    let chars: Vec<char> = s.chars().collect(); // ‚ùå –ò—Å–ø—Ä–∞–≤—å—Ç–µ
    s.push_str(&format!(" (length: {})", len));
}
```

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- [[E0382-Borrow-Of-Moved-Value]] - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ move
- [[E0499-Cannot-Borrow-Mutably-Multiple-Times]] - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è–µ–º—ã–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è
- [[E0597-Borrowed-Value-Does-Not-Live-Long-Enough]] - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ
- [[02-Ownership/Borrowing]] - –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è
- [[02-Ownership/Reference-Rules]] - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å—Å—ã–ª–æ–∫
- [[Non-Lexical-Lifetimes]] - NLL –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏

#error-E0502 #borrowing #mutable #immutable #common-error #intermediate